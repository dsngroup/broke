<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Introduction · Broke</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;h1&gt;&lt;a class=&quot;anchor&quot; aria-hidden=&quot;true&quot; id=&quot;broke&quot;&gt;&lt;/a&gt;&lt;a href=&quot;#broke&quot; aria-hidden=&quot;true&quot; class=&quot;hash-link&quot;&gt;&lt;svg class=&quot;hash-link-icon&quot; aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Broke&lt;/h1&gt;
"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Introduction · Broke"/><meta property="og:type" content="website"/><meta property="og:url" content="https://dsngroup.github.io/broke/index.html"/><meta property="og:description" content="&lt;h1&gt;&lt;a class=&quot;anchor&quot; aria-hidden=&quot;true&quot; id=&quot;broke&quot;&gt;&lt;/a&gt;&lt;a href=&quot;#broke&quot; aria-hidden=&quot;true&quot; class=&quot;hash-link&quot;&gt;&lt;svg class=&quot;hash-link-icon&quot; aria-hidden=&quot;true&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Broke&lt;/h1&gt;
"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/broke/undefined"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/broke/css/main.css"/></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/broke/"><h2 class="headerTitle">Broke</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive siteNavItemActive"><a href="/broke/docs/introduction.html" target="_self">User Guide</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Overview</span></h2></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Overview</h3><ul><li class="navListItem navListItemActive"><a class="navItem" href="/broke/docs/introduction.html">Introduction</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Getting Started</h3><ul><li class="navListItem"><a class="navItem" href="/broke/docs/deployment.html">Deployment</a></li><li class="navListItem"><a class="navItem" href="/broke/docs/connect.html">Connect</a></li><li class="navListItem"><a class="navItem" href="/broke/docs/publish.html">Publish</a></li><li class="navListItem"><a class="navItem" href="/broke/docs/subscribe.html">Subscribe</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Examples</h3><ul><li class="navListItem"><a class="navItem" href="/broke/docs/example.html">Consumer Group</a></li></ul></div></div></section></div><script>
            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Introduction</h1></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="broke"></a><a href="#broke" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Broke</h1>
<p>Broke is a message broker designed for IoT message brokering. It is based on MQTT, a machine-to-machine (M2M)/&quot;Internet of Things&quot; connectivity protocol, which was designed as an extremely lightweight publish/subscribe messaging transport. Broke not only provides a solution for message brokering, but is dedicated to solving the case of latency-sensitive applications.</p>
<h2><a class="anchor" aria-hidden="true" id="latency-sensitive-iot-application"></a><a href="#latency-sensitive-iot-application" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Latency-Sensitive IoT Application</h2>
<p>Latency-sensitive IoT application is one of important type of IoT applications. latency-sensitive IoT application needs to respond fast to specific events in order to avoid system failure or to prevent disasters. For example, a smart surveillance system detects intruders entering a bank’s building. The requirement of such system is latency-sensitive because the response to an intrusion must be in time in order to take pictures successfully. The system involves several drones patrolling the area, cameras moving along the floors and IR sensors deployed at critical spaces to detect suspicious behaviors. If an intruder is detected, the cameras and drones take a picture and sends alarm message to the guard of the building immediately. In the above case, the analysis of video from drones and cameras needs to be performed on powerful machines such as cloud data centers. The transmission of video takes network latency and the analysis tasks take computation latency. Therefore, building a latency-sensitive application is a challenge work because many factors cause latency in IoT operational environment.</p>
<h2><a class="anchor" aria-hidden="true" id="background-from-edge-to-geo-distributed-processing-units"></a><a href="#background-from-edge-to-geo-distributed-processing-units" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Background: From edge to geo-distributed processing units.</h2>
<p>IoT broker is one way to transfer the data streams from data sources to processing units. However, the distance and the network transmission latency between data sources and processing units are different because of the complex network topology (e.g. WAN) and the diversity of communication technologies (e.g. WiFi, 4G/LTE, and Ethernet).
On the other hand, the computation capability on processing units are also different because of the diversity of edge devices. Therefore, dispatching data streams to different processing units causes different degree of latency. In latency-sensitive IoT applications, if the IoT broker dispatches workload to the processing unit with time-critical requirement meets long network distance or computation latency, the constraint of the event handling may violate and cause the disaster.
A traditional broker in IoT can do simple data routing mechanism only, such as data broadcasting. There is no broker implementation in IoT that takes latency into consideration currently so that a critical event can be routed to a processing unit with high network and computation latency, which may violate the real-time constraint for event handling.
To respond fast toward critical events for latency-sensitive IoT applications, how to dispatch (i.e. load balancing) workload to feasible processing units is the critical problem that needs to solve.</p>
<h2><a class="anchor" aria-hidden="true" id="broke-the-message-brokering-solution-to-latency-sensitive-iot-applications"></a><a href="#broke-the-message-brokering-solution-to-latency-sensitive-iot-applications" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Broke: The message brokering solution to latency-sensitive IoT applications</h2>
<p>Broke is a latency-sensitive broker that optimizes processing time on workload handling. Broke dispatches the workload to a set of processing units that can balance the load between each other called consumer group.
We designed Latency-Sensitive Message Dispatching (LSMD) algorithm for selecting processing units from each consumer group based on the latency-related factors in order to reduce the dispatching latency.</p>
<h2><a class="anchor" aria-hidden="true" id="latency-sensitive-message-dispatching-lsmd-algorithm"></a><a href="#latency-sensitive-message-dispatching-lsmd-algorithm" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Latency Sensitive Message Dispatching (LSMD) Algorithm</h2>
<p>LSMD runs under a popular message brokering protocol called MQTT. We contribute three functionalities on MQTT[] to support the functionality of LSMD.</p>
<ol>
<li>To support the load-balancing communication paradigm, we implemented the consumer group mechanism over MQTT.</li>
<li>To make the broker aware of the network latency of each processing unit, we extend the MQTT protocol for the measurement of Round-Trip Time (RTT) between the broker and the processing unit.</li>
<li>To make the broker aware of the computational latency of processing units, we implemented the watermark-based back-pressure[], a mechanism which indicates whether a processing unit is overloaded. With these extensions of MQTT, the latency-sensitive broker can detect the latency conditions of the processing units. The LSMD is able to dispatch workload to each consumer group based on the latency-related metrics.</li>
</ol>
<h3><a class="anchor" aria-hidden="true" id="consumer-group"></a><a href="#consumer-group" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Consumer Group</h3>
<p><img src="broke/img/consumergroup.png" alt="Drawing" style="width: 350px;"/>
Consumers can be grouped into a consumer group for load balancing.</p>
<p>The concept of the consumer group is motivated by <a href="https://kafka.apache.org/documentation/#intro_consumers">Kafka’s consumer group</a> mechanism. The subscribe clients in the consumer group are processes that run the same task which can offload tasks from each other</p>
<p>In the publish/subscribe system, the consumers are subscribe clients and the workload are messages published from publish clients. The consumers in a consumer group subscribe to a same topic and shares a group ID. Once a publish message matches a subscription of a consumer group, the message is dispatched to one of the consumers in the consumer group. For example, when the publish client publishes a message of topic 1, the message will be forwarded to one of the consumers in consumer group 1 and 2, which subscribe topic 1.</p>
<h3><a class="anchor" aria-hidden="true" id="overview-of-lsmd-algorithm"></a><a href="#overview-of-lsmd-algorithm" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Overview of LSMD Algorithm</h3>
<p><img src="broke/img/LSMD.png" alt="Drawing" style="width: 350px;"/></p>
<p>LSMD selects the consumer in a consumer group based on the latency-related metrics:</p>
<ul>
<li>Round-Trip Time (RTT) between the broker and the client.</li>
<li>Back-Pressure status: The client runs watermark-based back-pressure (Adopted from <a href="http://jobs.one2team.com/apache-storms/">Apache Storm Back Pressure</a>) so the broker can try to lower the throughput to the client if the client is &quot;back-pressured&quot;.</li>
</ul>
</span></div></article></div><div class="docs-prevnext"><a class="docs-next button" href="/broke/docs/deployment.html"><span>Deployment</span><span class="arrow-next"> →</span></a></div></div></div></div><footer class="nav-footer" id="footer"><section class="copyright">Copyright © 2018 Dependable System and Network Lab, National Taiwan University.</section></footer></div></body></html>